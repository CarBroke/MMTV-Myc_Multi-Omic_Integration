library(deconstructSigs)
library(BSgenome)
library(BSgenome.Mmusculus.UCSC.mm10)
mutsigtable <- read.delim("TA39_927SigProfileExtractor.vcf")
colnames(mutsigtable) = c("Sample", "chr", "pos", "ref", "alt")
m = as.data.frame(mutsigtable)
sigs.input = mut.to.sigs.input(mut.ref = m, sample.id = "Sample", chr = "chr", pos = "pos", ref = "ref", alt = "alt", bsg = BSgenome.Mmusculus.UCSC.mm10)
sigs.input
output.sigs = whichSignatures(tumor.ref = sigs.input, signatures.ref = signatures.cosmic, contexts.needed = TRUE, tri.counts.method = "genome")
output.sigs
plotSignatures(output.sigs, sub = "Squamous_927")
makePie(output.sigs)

mutsigtable <- read.delim("TA41_1938SigProfileExtractor.vcf")
colnames(mutsigtable) = c("Sample", "chr", "pos", "ref", "alt")
m = as.data.frame(mutsigtable)
sigs.input = mut.to.sigs.input(mut.ref = m, sample.id = "Sample", chr = "chr", pos = "pos", ref = "ref", alt = "alt", bsg = BSgenome.Mmusculus.UCSC.mm10)
output.sigs = whichSignatures(tumor.ref = sigs.input, signatures.ref = signatures.cosmic, contexts.needed = TRUE, tri.counts.method = "genome")
plotSignatures(output.sigs, sub = "EMT_1938")
makePie(output.sigs)

mutsigtable <- read.delim("WT13_842SigProfileExtractor.vcf")
colnames(mutsigtable) = c("Sample", "chr", "pos", "ref", "alt")
m = as.data.frame(mutsigtable)
sigs.input = mut.to.sigs.input(mut.ref = m, sample.id = "Sample", chr = "chr", pos = "pos", ref = "ref", alt = "alt", bsg = BSgenome.Mmusculus.UCSC.mm10)
output.sigs = whichSignatures(tumor.ref = sigs.input, signatures.ref = signatures.cosmic, contexts.needed = TRUE, tri.counts.method = "genome")
plotSignatures(output.sigs, sub = "Microacinar_842")
makePie(output.sigs)

mutsigtable <- read.delim("WT13_864SigProfileExtractor.vcf")
colnames(mutsigtable) = c("Sample", "chr", "pos", "ref", "alt")
m = as.data.frame(mutsigtable)
sigs.input = mut.to.sigs.input(mut.ref = m, sample.id = "Sample", chr = "chr", pos = "pos", ref = "ref", alt = "alt", bsg = BSgenome.Mmusculus.UCSC.mm10)
output.sigs = whichSignatures(tumor.ref = sigs.input, signatures.ref = signatures.cosmic, contexts.needed = TRUE, tri.counts.method = "genome")
plotSignatures(output.sigs, sub = "Microacinar_842")
makePie(output.sigs)

mutsigtable <- read.delim("WT13_1356SigProfileExtractor.vcf")
colnames(mutsigtable) = c("Sample", "chr", "pos", "ref", "alt")
m = as.data.frame(mutsigtable)
sigs.input = mut.to.sigs.input(mut.ref = m, sample.id = "Sample", chr = "chr", pos = "pos", ref = "ref", alt = "alt", bsg = BSgenome.Mmusculus.UCSC.mm10)
output.sigs = whichSignatures(tumor.ref = sigs.input, signatures.ref = signatures.cosmic, contexts.needed = TRUE, tri.counts.method = "genome")
plotSignatures(output.sigs, sub = "EMT_1356")
makePie(output.sigs)

mutsigtable <- read.delim("WT13_1445SigProfileExtractor.vcf")
colnames(mutsigtable) = c("Sample", "chr", "pos", "ref", "alt")
m = as.data.frame(mutsigtable)
sigs.input = mut.to.sigs.input(mut.ref = m, sample.id = "Sample", chr = "chr", pos = "pos", ref = "ref", alt = "alt", bsg = BSgenome.Mmusculus.UCSC.mm10)
output.sigs = whichSignatures(tumor.ref = sigs.input, signatures.ref = signatures.cosmic, contexts.needed = TRUE, tri.counts.method = "genome")
plotSignatures(output.sigs, sub = "Squamous_1445")
makePie(output.sigs)

mutsigtable <- read.delim("WT13_1576SigProfileExtractor.vcf")
colnames(mutsigtable) = c("Sample", "chr", "pos", "ref", "alt")
m = as.data.frame(mutsigtable)
sigs.input = mut.to.sigs.input(mut.ref = m, sample.id = "Sample", chr = "chr", pos = "pos", ref = "ref", alt = "alt", bsg = BSgenome.Mmusculus.UCSC.mm10)
output.sigs = whichSignatures(tumor.ref = sigs.input, signatures.ref = signatures.cosmic, contexts.needed = TRUE, tri.counts.method = "genome")
plotSignatures(output.sigs, sub = "Microacinar_1576")
makePie(output.sigs)

mutsigtable <- read.delim("WT21_222SigProfileExtractor.vcf")
colnames(mutsigtable) = c("Sample", "chr", "pos", "ref", "alt")
m = as.data.frame(mutsigtable)
sigs.input = mut.to.sigs.input(mut.ref = m, sample.id = "Sample", chr = "chr", pos = "pos", ref = "ref", alt = "alt", bsg = BSgenome.Mmusculus.UCSC.mm10)
output.sigs = whichSignatures(tumor.ref = sigs.input, signatures.ref = signatures.cosmic, contexts.needed = TRUE, tri.counts.method = "genome")
plotSignatures(output.sigs, "EMT_222")
makePie(output.sigs)

mutsigtable <- read.delim("WT21_1066SigProfileExtractor.vcf")
colnames(mutsigtable) = c("Sample", "chr", "pos", "ref", "alt")
m = as.data.frame(mutsigtable)
sigs.input = mut.to.sigs.input(mut.ref = m, sample.id = "Sample", chr = "chr", pos = "pos", ref = "ref", alt = "alt", bsg = BSgenome.Mmusculus.UCSC.mm10)
output.sigs = whichSignatures(tumor.ref = sigs.input, signatures.ref = signatures.cosmic, contexts.needed = TRUE, tri.counts.method = "genome")
plotSignatures(output.sigs, sub = "Squamous_1066")
makePie(output.sigs)

mutsigtable <- read.delim("1357SigProfileExtractor.vcf")
colnames(mutsigtable) = c("Sample", "chr", "pos", "ref", "alt")
m = as.data.frame(mutsigtable)
sigs.input = mut.to.sigs.input(mut.ref = m, sample.id = "Sample", chr = "chr", pos = "pos", ref = "ref", alt = "alt", bsg = BSgenome.Mmusculus.UCSC.mm10)
output.sigs = whichSignatures(tumor.ref = sigs.input, signatures.ref = signatures.cosmic, contexts.needed = TRUE, tri.counts.method = "genome")
plotSignatures(output.sigs)
makePie(output.sigs)

mutsigtable <- read.delim("1894SigProfileExtractor.vcf")
colnames(mutsigtable) = c("Sample", "chr", "pos", "ref", "alt")
m = as.data.frame(mutsigtable)
sigs.input = mut.to.sigs.input(mut.ref = m, sample.id = "Sample", chr = "chr", pos = "pos", ref = "ref", alt = "alt", bsg = BSgenome.Mmusculus.UCSC.mm10)
output.sigs = whichSignatures(tumor.ref = sigs.input, signatures.ref = signatures.cosmic, contexts.needed = TRUE, tri.counts.method = "genome")
plotSignatures(output.sigs)
makePie(output.sigs)

mutsigtable <- read.delim("2187SigProfileExtractor.vcf")
colnames(mutsigtable) = c("Sample", "chr", "pos", "ref", "alt")
m = as.data.frame(mutsigtable)
sigs.input = mut.to.sigs.input(mut.ref = m, sample.id = "Sample", chr = "chr", pos = "pos", ref = "ref", alt = "alt", bsg = BSgenome.Mmusculus.UCSC.mm10)
output.sigs = whichSignatures(tumor.ref = sigs.input, signatures.ref = signatures.cosmic, contexts.needed = TRUE, tri.counts.method = "genome")
plotSignatures(output.sigs)
makePie(output.sigs)

mutsigtable <- read.delim("302SigProfileExtractor.vcf")
colnames(mutsigtable) = c("Sample", "chr", "pos", "ref", "alt")
m = as.data.frame(mutsigtable)
sigs.input = mut.to.sigs.input(mut.ref = m, sample.id = "Sample", chr = "chr", pos = "pos", ref = "ref", alt = "alt", bsg = BSgenome.Mmusculus.UCSC.mm10)
output.sigs = whichSignatures(tumor.ref = sigs.input, signatures.ref = signatures.cosmic, contexts.needed = TRUE, tri.counts.method = "genome")
plotSignatures(output.sigs)
makePie(output.sigs)

mutsigtable <- read.delim("3136SigProfileExtractor.vcf")
colnames(mutsigtable) = c("Sample", "chr", "pos", "ref", "alt")
m = as.data.frame(mutsigtable)
sigs.input = mut.to.sigs.input(mut.ref = m, sample.id = "Sample", chr = "chr", pos = "pos", ref = "ref", alt = "alt", bsg = BSgenome.Mmusculus.UCSC.mm10)
output.sigs = whichSignatures(tumor.ref = sigs.input, signatures.ref = signatures.cosmic, contexts.needed = TRUE, tri.counts.method = "genome")
plotSignatures(output.sigs)
makePie(output.sigs)

mutsigtable <- read.delim("3304SigProfileExtractor.vcf")
colnames(mutsigtable) = c("Sample", "chr", "pos", "ref", "alt")
m = as.data.frame(mutsigtable)
sigs.input = mut.to.sigs.input(mut.ref = m, sample.id = "Sample", chr = "chr", pos = "pos", ref = "ref", alt = "alt", bsg = BSgenome.Mmusculus.UCSC.mm10)
output.sigs = whichSignatures(tumor.ref = sigs.input, signatures.ref = signatures.cosmic, contexts.needed = TRUE, tri.counts.method = "genome")
plotSignatures(output.sigs)
makePie(output.sigs)

#Sample column must be a string and not a float or int
mutsigtable <- read.delim("3790SigProfileExtractor.vcf")
colnames(mutsigtable) = c("Sample", "chr", "pos", "ref", "alt")
m = as.data.frame(mutsigtable)
sigs.input = mut.to.sigs.input(mut.ref = m, sample.id = "Sample", chr = "chr", pos = "pos", ref = "ref", alt = "alt", bsg = BSgenome.Mmusculus.UCSC.mm10)
output.sigs = whichSignatures(tumor.ref = sigs.input, signatures.ref = signatures.cosmic, contexts.needed = TRUE, tri.counts.method = "genome")
plotSignatures(output.sigs)
makePie(output.sigs)
output.sigs

mutsigtable <- read.delim("3790_tumor2SigProfileExtractor.vcf")
colnames(mutsigtable) = c("Sample", "chr", "pos", "ref", "alt")
m = as.data.frame(mutsigtable)
sigs.input = mut.to.sigs.input(mut.ref = m, sample.id = "Sample", chr = "chr", pos = "pos", ref = "ref", alt = "alt", bsg = BSgenome.Mmusculus.UCSC.mm10)
output.sigs = whichSignatures(tumor.ref = sigs.input, signatures.ref = signatures.cosmic, contexts.needed = TRUE, tri.counts.method = "genome")
plotSignatures(output.sigs)
makePie(output.sigs)

mutsigtable <- read.delim("3976SigProfileExtractor.vcf")
colnames(mutsigtable) = c("Sample", "chr", "pos", "ref", "alt")
m = as.data.frame(mutsigtable)
sigs.input = mut.to.sigs.input(mut.ref = m, sample.id = "Sample", chr = "chr", pos = "pos", ref = "ref", alt = "alt", bsg = BSgenome.Mmusculus.UCSC.mm10)
output.sigs = whichSignatures(tumor.ref = sigs.input, signatures.ref = signatures.cosmic, contexts.needed = TRUE, tri.counts.method = "genome")
plotSignatures(output.sigs)
makePie(output.sigs)

mutsigtable <- read.delim("5492SigProfileExtractor.vcf")
colnames(mutsigtable) = c("Sample", "chr", "pos", "ref", "alt")
m = as.data.frame(mutsigtable)
sigs.input = mut.to.sigs.input(mut.ref = m, sample.id = "Sample", chr = "chr", pos = "pos", ref = "ref", alt = "alt", bsg = BSgenome.Mmusculus.UCSC.mm10)
output.sigs = whichSignatures(tumor.ref = sigs.input, signatures.ref = signatures.cosmic, contexts.needed = TRUE, tri.counts.method = "genome")
plotSignatures(output.sigs)
makePie(output.sigs)

mutsigtable <- read.delim("5691SigProfileExtractor.vcf")
colnames(mutsigtable) = c("Sample", "chr", "pos", "ref", "alt")
m = as.data.frame(mutsigtable)
sigs.input = mut.to.sigs.input(mut.ref = m, sample.id = "Sample", chr = "chr", pos = "pos", ref = "ref", alt = "alt", bsg = BSgenome.Mmusculus.UCSC.mm10)
output.sigs = whichSignatures(tumor.ref = sigs.input, signatures.ref = signatures.cosmic, contexts.needed = TRUE, tri.counts.method = "genome")
plotSignatures(output.sigs)
makePie(output.sigs)
